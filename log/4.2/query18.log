Timing is on.
select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 313
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice |  sum   
--------------------+-----------+------------+-------------+--------------+--------
 Customer#000021433 |     21433 |    1750466 | 1992-11-30  |    555285.16 | 900.00
 Customer#000021433 |     21433 |    1750466 | 1999-11-30  |    555285.16 | 900.00
 Customer#000021433 |     21433 |    1750466 | 2006-11-30  |    555285.16 | 900.00
 Customer#000128120 |    128120 |    4722021 | 1994-04-07  |    544089.09 | 969.00
 Customer#000128120 |    128120 |    4722021 | 2001-04-07  |    544089.09 | 969.00
 Customer#000128120 |    128120 |    4722021 | 2008-04-07  |    544089.09 | 969.00
 Customer#000144617 |    144617 |    3043270 | 1997-02-12  |    530604.44 | 951.00
 Customer#000144617 |    144617 |    3043270 | 2004-02-12  |    530604.44 | 951.00
 Customer#000144617 |    144617 |    3043270 | 2011-02-12  |    530604.44 | 951.00
 Customer#000108931 |    108931 |    4576548 | 1997-12-26  |    525590.57 | 885.00
 Customer#000108931 |    108931 |    4576548 | 2004-12-26  |    525590.57 | 885.00
 Customer#000108931 |    108931 |    4576548 | 2011-12-26  |    525590.57 | 885.00
 Customer#000013940 |     13940 |    2232932 | 1997-04-13  |    522720.61 | 912.00
 Customer#000013940 |     13940 |    2232932 | 2004-04-13  |    522720.61 | 912.00
 Customer#000013940 |     13940 |    2232932 | 2011-04-13  |    522720.61 | 912.00
 Customer#000024049 |     24049 |    3586919 | 1992-11-07  |    522644.48 | 897.00
 Customer#000024049 |     24049 |    3586919 | 1999-11-07  |    522644.48 | 897.00
 Customer#000024049 |     24049 |    3586919 | 2006-11-07  |    522644.48 | 897.00
 Customer#000066790 |     66790 |    2199712 | 1996-09-30  |    515531.82 | 981.00
 Customer#000066790 |     66790 |    2199712 | 2003-09-30  |    515531.82 | 981.00
 Customer#000066790 |     66790 |    2199712 | 2010-09-30  |    515531.82 | 981.00
 Customer#000051796 |     51796 |    2185667 | 1992-10-08  |    511359.88 | 858.00
 Customer#000051796 |     51796 |    2185667 | 1999-10-08  |    511359.88 | 858.00
 Customer#000051796 |     51796 |    2185667 | 2006-10-08  |    511359.88 | 858.00
 Customer#000100685 |    100685 |    4515876 | 1993-11-02  |    510061.60 | 879.00
 Customer#000100685 |    100685 |    4515876 | 2000-11-02  |    510061.60 | 879.00
 Customer#000100685 |    100685 |    4515876 | 2007-11-02  |    510061.60 | 879.00
 Customer#000141100 |    141100 |     972901 | 1992-07-18  |    508668.52 | 879.00
 Customer#000141100 |    141100 |     972901 | 1999-07-18  |    508668.52 | 879.00
 Customer#000141100 |    141100 |     972901 | 2006-07-18  |    508668.52 | 879.00
 Customer#000046435 |     46435 |    4745607 | 1997-07-03  |    508047.99 | 927.00
 Customer#000046435 |     46435 |    4745607 | 2004-07-03  |    508047.99 | 927.00
 Customer#000046435 |     46435 |    4745607 | 2011-07-03  |    508047.99 | 927.00
 Customer#000050327 |     50327 |    1177378 | 1992-09-19  |    508010.56 | 861.00
 Customer#000050327 |     50327 |    1177378 | 1999-09-19  |    508010.56 | 861.00
 Customer#000050327 |     50327 |    1177378 | 2006-09-19  |    508010.56 | 861.00
 Customer#000008936 |      8936 |     631651 | 1992-06-30  |    504509.06 | 870.00
 Customer#000008936 |      8936 |     631651 | 1999-06-30  |    504509.06 | 870.00
 Customer#000008936 |      8936 |     631651 | 2006-06-30  |    504509.06 | 870.00
 Customer#000109186 |    109186 |    3967937 | 1995-07-27  |    502906.33 | 894.00
 Customer#000109186 |    109186 |    3967937 | 2002-07-27  |    502906.33 | 894.00
 Customer#000109186 |    109186 |    3967937 | 2009-07-27  |    502906.33 | 894.00
 Customer#000100159 |    100159 |    1395745 | 1998-07-28  |    502742.76 | 891.00
 Customer#000100159 |    100159 |    1395745 | 2005-07-28  |    502742.76 | 891.00
 Customer#000100159 |    100159 |    1395745 | 2012-07-28  |    502742.76 | 891.00
 Customer#000015272 |     15272 |    3883783 | 1993-07-28  |    500241.33 | 906.00
 Customer#000015272 |     15272 |    3883783 | 2000-07-28  |    500241.33 | 906.00
 Customer#000015272 |     15272 |    3883783 | 2007-07-28  |    500241.33 | 906.00
 Customer#000146608 |    146608 |    3342468 | 1994-06-12  |    499794.58 | 909.00
 Customer#000146608 |    146608 |    3342468 | 2001-06-12  |    499794.58 | 909.00
 Customer#000146608 |    146608 |    3342468 | 2008-06-12  |    499794.58 | 909.00
 Customer#000052516 |     52516 |    5709632 | 1995-08-15  |    499753.01 | 840.00
 Customer#000052516 |     52516 |    5709632 | 2002-08-15  |    499753.01 | 840.00
 Customer#000052516 |     52516 |    5709632 | 2009-08-15  |    499753.01 | 840.00
 Customer#000146188 |    146188 |    5471879 | 1993-09-02  |    499290.83 | 876.00
 Customer#000146188 |    146188 |    5471879 | 2000-09-02  |    499290.83 | 876.00
 Customer#000146188 |    146188 |    5471879 | 2007-09-02  |    499290.83 | 876.00
 Customer#000146612 |    146612 |    2474850 | 1994-06-26  |    498810.26 | 870.00
 Customer#000146612 |    146612 |    2474850 | 2001-06-26  |    498810.26 | 870.00
 Customer#000146612 |    146612 |    2474850 | 2008-06-26  |    498810.26 | 870.00
 Customer#000056620 |     56620 |    2152359 | 1996-05-22  |    498599.91 | 873.00
 Customer#000056620 |     56620 |    2152359 | 2003-05-22  |    498599.91 | 873.00
 Customer#000056620 |     56620 |    2152359 | 2010-05-22  |    498599.91 | 873.00
 Customer#000033083 |     33083 |    2121671 | 1994-08-13  |    497529.23 | 870.00
 Customer#000033083 |     33083 |    2121671 | 2001-08-13  |    497529.23 | 870.00
 Customer#000033083 |     33083 |    2121671 | 2008-08-13  |    497529.23 | 870.00
 Customer#000144688 |    144688 |     413762 | 1994-01-05  |    496620.48 | 882.00
 Customer#000144688 |    144688 |     413762 | 2001-01-05  |    496620.48 | 882.00
 Customer#000144688 |    144688 |     413762 | 2008-01-05  |    496620.48 | 882.00
 Customer#000039478 |     39478 |    5852742 | 1994-09-08  |    496241.97 | 852.00
 Customer#000039478 |     39478 |    5852742 | 2001-09-08  |    496241.97 | 852.00
 Customer#000039478 |     39478 |    5852742 | 2008-09-08  |    496241.97 | 852.00
 Customer#000004765 |      4765 |     217541 | 1993-01-16  |    496167.96 | 891.00
 Customer#000004765 |      4765 |     217541 | 2000-01-16  |    496167.96 | 891.00
 Customer#000004765 |      4765 |     217541 | 2007-01-16  |    496167.96 | 891.00
 Customer#000054733 |     54733 |    4764774 | 1992-10-25  |    496139.09 | 852.00
 Customer#000054733 |     54733 |    4764774 | 1999-10-25  |    496139.09 | 852.00
 Customer#000054733 |     54733 |    4764774 | 2006-10-25  |    496139.09 | 852.00
 Customer#000115841 |    115841 |    2756705 | 1993-03-07  |    495297.13 | 879.00
 Customer#000115841 |    115841 |    2756705 | 2000-03-07  |    495297.13 | 879.00
 Customer#000115841 |    115841 |    2756705 | 2007-03-07  |    495297.13 | 879.00
 Customer#000099446 |     99446 |    1672039 | 1997-11-17  |    495148.48 | 876.00
 Customer#000099446 |     99446 |    1672039 | 2004-11-17  |    495148.48 | 876.00
 Customer#000099446 |     99446 |    1672039 | 2011-11-17  |    495148.48 | 876.00
 Customer#000100810 |    100810 |    3307010 | 1998-05-04  |    494747.48 | 801.00
 Customer#000100810 |    100810 |    3307010 | 2005-05-04  |    494747.48 | 801.00
 Customer#000100810 |    100810 |    3307010 | 2012-05-04  |    494747.48 | 801.00
 Customer#000096103 |     96103 |    5984582 | 1992-03-16  |    494398.79 | 936.00
 Customer#000096103 |     96103 |    5984582 | 1999-03-16  |    494398.79 | 936.00
 Customer#000096103 |     96103 |    5984582 | 2006-03-16  |    494398.79 | 936.00
 Customer#000001045 |      1045 |      95808 | 1995-10-10  |    492147.15 | 822.00
 Customer#000001045 |      1045 |      95808 | 2002-10-10  |    492147.15 | 822.00
 Customer#000001045 |      1045 |      95808 | 2009-10-10  |    492147.15 | 822.00
 Customer#000095857 |     95857 |    3597604 | 1993-01-14  |    491820.73 | 858.00
 Customer#000095857 |     95857 |    3597604 | 2000-01-14  |    491820.73 | 858.00
 Customer#000095857 |     95857 |    3597604 | 2007-01-14  |    491820.73 | 858.00
 Customer#000101831 |    101831 |    4311651 | 1995-04-21  |    491549.57 | 801.00
 Customer#000101831 |    101831 |    4311651 | 2002-04-21  |    491549.57 | 801.00
 Customer#000101831 |    101831 |    4311651 | 2009-04-21  |    491549.57 | 801.00
 Customer#000024341 |     24341 |    1474818 | 1992-11-15  |    491348.26 | 906.00
(100 rows)

Time: 142412.906 ms
